<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 æ±äº¬æ—…éŠåŠ©æ‰‹</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        [v-cloak] { display: none; }
        body { font-family: -apple-system, "Noto Sans TC", sans-serif; -webkit-tap-highlight-color: transparent; background-color: #f8fafc; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass-header { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .hotel-card { background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 1px solid #bfdbfe; }
    </style>
</head>
<body class="pb-24">

    <div id="app" v-cloak>
        <header class="p-4 bg-white border-b sticky top-0 z-50 flex justify-between items-center glass-header">
            <div>
                <h1 class="font-bold text-lg leading-none text-blue-900">TOKYO 2026</h1>
                <p class="text-[10px] text-blue-500 mt-1 font-black uppercase tracking-widest">Transit Master</p>
            </div>
            <div class="bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-mono font-bold">
                {{ exchangeRate }} JPY/TWD
            </div>
        </header>

        <nav class="sticky top-[57px] z-40 bg-white border-b shadow-sm">
            <div class="flex overflow-x-auto p-3 space-x-2 no-scrollbar">
                <button v-for="(day, index) in itinerary" :key="index" 
                    @click="currentDayIndex = index"
                    :class="['px-5 py-2 rounded-2xl text-sm font-bold transition-all', 
                            currentDayIndex === index ? 'bg-blue-600 text-white shadow-lg' : 'bg-gray-100 text-gray-400']">
                    D{{ index + 1 }}
                </button>
            </div>
        </nav>

        <main class="p-4 space-y-4">
            
            <section class="hotel-card rounded-3xl p-5 shadow-sm relative overflow-hidden">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-[10px] bg-blue-500 text-white px-2 py-0.5 rounded font-black uppercase">Accommodation</span>
                    <button @click="openHotelModal" class="text-blue-400 p-1"><i class="fas fa-edit"></i> ç·¨è¼¯</button>
                </div>
                
                <h2 class="text-xl font-bold text-blue-900 leading-tight">{{ itinerary[currentDayIndex].hotel }}</h2>
                <p class="text-xs text-blue-600/70 mt-1 mb-4 italic">{{ itinerary[currentDayIndex].hotelAddr || 'å°šæœªè¼¸å…¥åœ°å€' }}</p>

                <div v-if="itinerary[currentDayIndex].hotelVoucher" class="mb-4 rounded-xl overflow-hidden border border-blue-200">
                    <img :src="itinerary[currentDayIndex].hotelVoucher" class="w-full h-auto">
                </div>

                <div class="flex gap-2">
                    <a :href="'https://www.google.com/maps/dir/?api=1&destination=' + encodeURIComponent(itinerary[currentDayIndex].hotel) + '&travelmode=transit'" 
                       target="_blank"
                       class="flex-1 bg-white text-blue-600 text-center py-3 rounded-2xl text-sm font-bold shadow-sm active:scale-95 transition">
                       ğŸšƒ å‰å¾€é£¯åº—å°èˆª
                    </a>
                    <label class="w-14 bg-blue-100 flex items-center justify-center rounded-2xl cursor-pointer text-blue-600">
                        ğŸ“„ <input type="file" class="hidden" @change="uploadHotelVoucher">
                    </label>
                </div>
            </section>

            <div v-for="(spot, sIndex) in itinerary[currentDayIndex].spots" :key="spot.id" 
                 class="bg-white rounded-3xl p-5 shadow-sm border border-gray-100 relative">
                <div class="flex justify-between items-center mb-2">
                    <span :class="['text-[10px] px-2 py-0.5 rounded font-bold uppercase', typeClass(spot.type)]">{{ spot.type }}</span>
                    <button @click="removeSpot(sIndex)" class="text-gray-200">âœ•</button>
                </div>
                <h3 class="font-bold text-lg text-gray-800 leading-tight">{{ spot.name }}</h3>
                <p class="text-sm text-gray-500 mt-2 mb-4 whitespace-pre-line">{{ spot.note }}</p>
                <div v-if="spot.photo" class="mb-4 rounded-2xl overflow-hidden shadow-sm"><img :src="spot.photo" class="w-full h-48 object-cover"></div>
                <div class="flex gap-2">
                    <a :href="'https://www.google.com/maps/dir/?api=1&destination=' + encodeURIComponent(spot.name) + '&travelmode=transit'" target="_blank"
                       class="flex-1 bg-gray-900 text-white text-center py-3.5 rounded-2xl text-sm font-bold shadow-lg active:scale-95 transition">ğŸšƒ å°èˆª</a>
                    <label class="w-14 bg-gray-100 flex items-center justify-center rounded-2xl cursor-pointer"><i class="fas fa-camera"></i>ğŸ“·<input type="file" class="hidden" @change="uploadPhoto($event, sIndex)"></label>
                </div>
            </div>

            <button @click="isModalOpen = true" class="w-full py-5 border-2 border-dashed border-gray-300 rounded-3xl text-gray-400 font-bold">+ æ–°å¢è¡Œç¨‹åœ°é»</button>
        </main>

        <div v-if="isHotelModalOpen" class="fixed inset-0 bg-black/60 z-[100] flex items-end">
            <div class="bg-white w-full rounded-t-[32px] p-6 pb-12 shadow-2xl">
                <h2 class="text-xl font-bold mb-4">ç·¨è¼¯ä½å®¿è³‡è¨Š</h2>
                <input v-model="hotelForm.name" placeholder="é£¯åº—åç¨±" class="w-full p-4 bg-gray-100 rounded-2xl mb-3 outline-none">
                <input v-model="hotelForm.addr" placeholder="åœ°å€ (å°èˆªç²¾æº–ç”¨)" class="w-full p-4 bg-gray-100 rounded-2xl mb-4 outline-none">
                <div class="flex gap-3">
                    <button @click="isHotelModalOpen = false" class="flex-1 py-4 text-gray-400 font-bold">å–æ¶ˆ</button>
                    <button @click="saveHotelInfo" class="flex-[2] bg-blue-600 text-white py-4 rounded-2xl font-bold">å„²å­˜ä¿®æ”¹</button>
                </div>
            </div>
        </div>

        <div v-if="isModalOpen" class="fixed inset-0 bg-black/60 z-[100] flex items-end">
             <div class="bg-white w-full rounded-t-[32px] p-6 pb-12 shadow-2xl">
                <h2 class="text-xl font-bold mb-4">æ–°å¢è¡Œç¨‹</h2>
                <input v-model="newSpot.name" placeholder="åœ°é»åç¨±" class="w-full p-4 bg-gray-100 rounded-2xl mb-3 outline-none">
                <textarea v-model="newSpot.note" placeholder="å‚™è¨»..." class="w-full p-4 bg-gray-100 rounded-2xl mb-4 h-24 outline-none"></textarea>
                <div class="flex gap-3">
                    <button @click="isModalOpen = false" class="flex-1 py-4 text-gray-400 font-bold">å–æ¶ˆ</button>
                    <button @click="addSpot" class="flex-[2] bg-blue-600 text-white py-4 rounded-2xl font-bold">æ–°å¢</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        const STORAGE_KEY = 'tokyo_v4_transit';

        createApp({
            data() {
                return {
                    exchangeRate: '0.2115',
                    currentDayIndex: 0,
                    isModalOpen: false,
                    isHotelModalOpen: false,
                    hotelForm: { name: '', addr: '' },
                    newSpot: { name: '', note: '', type: 'spot', photo: null },
                    itinerary: []
                }
            },
            methods: {
                typeClass(type) {
                    const classes = { food: 'bg-red-50 text-red-500', spot: 'bg-indigo-50 text-indigo-500', shop: 'bg-emerald-50 text-emerald-500' };
                    return classes[type] || 'bg-gray-50 text-gray-500';
                },
                openHotelModal() {
                    const current = this.itinerary[this.currentDayIndex];
                    this.hotelForm = { name: current.hotel, addr: current.hotelAddr || '' };
                    this.isHotelModalOpen = true;
                },
                saveHotelInfo() {
                    this.itinerary[this.currentDayIndex].hotel = this.hotelForm.name;
                    this.itinerary[this.currentDayIndex].hotelAddr = this.hotelForm.addr;
                    this.saveData();
                    this.isHotelModalOpen = false;
                },
                uploadHotelVoucher(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.itinerary[this.currentDayIndex].hotelVoucher = e.target.result;
                            this.saveData();
                        };
                        reader.readAsDataURL(file);
                    }
                },
                addSpot() {
                    if (!this.newSpot.name) return;
                    this.itinerary[this.currentDayIndex].spots.push({ ...this.newSpot, id: Date.now() });
                    this.saveData();
                    this.newSpot = { name: '', note: '', type: 'spot', photo: null };
                    this.isModalOpen = false;
                },
                uploadPhoto(event, index) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.itinerary[this.currentDayIndex].spots[index].photo = e.target.result;
                            this.saveData();
                        };
                        reader.readAsDataURL(file);
                    }
                },
                saveData() { localStorage.setItem(STORAGE_KEY, JSON.stringify(this.itinerary)); },
                init() {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    if (saved) {
                        this.itinerary = JSON.parse(saved);
                    } else {
                        // åˆå§‹è³‡æ–™çµæ§‹ï¼ŒåŠ å…¥åœ°å€æ¬„ä½
                        this.itinerary = [
                            { date: '3/05', hotel: 'æ¸…æ¾„ç™½æ²³ Comfort Hotel', hotelAddr: 'æ±äº¬éƒ½æ±Ÿæ±å€ç™½æ²³1-6-12', hotelVoucher: null, spots: [{ id: 1, name: 'ç¾½ç”°æ©Ÿå ´ ç¬¬3èˆªå»ˆ', type: 'spot', note: 'æŠµé”' }] },
                            { date: '3/06', hotel: 'æ¸…æ¾„ç™½æ²³ Comfort Hotel', hotelAddr: 'æ±äº¬éƒ½æ±Ÿæ±å€ç™½æ²³1-6-12', spots: [] },
                            { date: '3/07', hotel: 'æ¸…æ¾„ç™½æ²³ Comfort Hotel', hotelAddr: '', spots: [] },
                            { date: '3/08', hotel: 'æ¸…æ¾„ç™½æ²³ Comfort Hotel', hotelAddr: '', spots: [] },
                            { date: '3/09', hotel: 'JRæ±æ—¥æœ¬é…’åº— Mets æ©«æ¿±', hotelAddr: 'ç¥å¥ˆå·ç¸£æ©«æ¿±å¸‚ç¥å¥ˆå·å€é¶´å±‹ç”º1-1-1', spots: [] },
                            { date: '3/10', hotel: 'JRæ±æ—¥æœ¬é…’åº— Mets æ©«æ¿±', hotelAddr: '', spots: [] },
                            { date: '3/11', hotel: 'Home', hotelAddr: '', spots: [] }
                        ];
                    }
                }
            },
            created() {
                this.init();
                fetch('https://api.exchangerate-api.com/v4/latest/JPY').then(r => r.json()).then(d => this.exchangeRate = d.rates.TWD.toFixed(4)).catch(()=>{});
            }
        }).mount('#app');
    </script>
</body>
</html>
